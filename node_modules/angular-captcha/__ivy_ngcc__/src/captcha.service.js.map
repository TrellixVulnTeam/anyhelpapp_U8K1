{"version":3,"file":"captcha.service.js","sources":["captcha.service.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAGM;AACN;AACA;AACA;AACA;AACA;AACA;;;;;;;;kCAAS;AACT;AACA;AACA;AACA","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar core_1 = require(\"@angular/core\");\r\nvar http_1 = require(\"@angular/common/http\");\r\nvar captcha_endpoint_pipe_1 = require(\"./captcha-endpoint.pipe\");\r\nvar config_1 = require(\"./config\");\r\nvar CaptchaService = /** @class */ (function () {\r\n    function CaptchaService(http, captchaEndpointPipe, config) {\r\n        this.http = http;\r\n        this.captchaEndpointPipe = captchaEndpointPipe;\r\n        this.config = config;\r\n    }\r\n    Object.defineProperty(CaptchaService.prototype, \"captchaStyleName\", {\r\n        get: function () {\r\n            return this._captchaStyleName;\r\n        },\r\n        set: function (captchaStyleName) {\r\n            this._captchaStyleName = captchaStyleName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CaptchaService.prototype, \"captchaEndpoint\", {\r\n        // the captcha endpoint for botdetect requests.\r\n        get: function () {\r\n            var captchaEndpoint = this._captchaEndpoint;\r\n            if (this.config && this.config.captchaEndpoint) {\r\n                captchaEndpoint = this.config.captchaEndpoint;\r\n            }\r\n            return this.captchaEndpointPipe.transform(captchaEndpoint);\r\n        },\r\n        set: function (captchaEndpoint) {\r\n            this._captchaEndpoint = captchaEndpoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CaptchaService.prototype, \"botdetectInstance\", {\r\n        // get botdetect instance, which is provided by botdetect script.\r\n        get: function () {\r\n            return BotDetect.getInstanceByStyleName(this.captchaStyleName);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // get captcha html markup from botdetect api.\r\n    CaptchaService.prototype.getHtml = function () {\r\n        if (!this.captchaEndpoint) {\r\n            var errorMessage = \"captchaEndpoint property is not set!\\n    The Angular Captcha Module requires the \\\"this.captchaComponent.captchaEndpoint\\\" property to be set.\\n    For example: \\n    ngOnInit(): void {\\n      this.captchaComponent.captchaEndpoint = 'https://your-app-backend-hostname.your-domain.com/simple-captcha-endpoint-path';\\n    }\\n      \";\r\n            throw new Error(errorMessage);\r\n        }\r\n        var url = this.captchaEndpoint + '?get=html&c=' + this.captchaStyleName;\r\n        return this.http.get(url, { responseType: 'text' });\r\n    };\r\n    // ui validate captcha.\r\n    CaptchaService.prototype.validateUnsafe = function (captchaCode) {\r\n        if (!this.botdetectInstance) {\r\n            throw new Error('BotDetect instance does not exist.');\r\n        }\r\n        var url = this.botdetectInstance.validationUrl + '&i=' + captchaCode;\r\n        return this.http.get(url);\r\n    };\r\n    CaptchaService.decorators = [\r\n        { type: core_1.Injectable },\r\n    ];\r\n    /** @nocollapse */\r\n    CaptchaService.ctorParameters = function () { return [\r\n        { type: http_1.HttpClient, },\r\n        { type: captcha_endpoint_pipe_1.CaptchaEndpointPipe, },\r\n        { type: undefined, decorators: [{ type: core_1.Inject, args: [config_1.CAPTCHA_SETTINGS,] },] },\r\n    ]; };\r\n    return CaptchaService;\r\n}());\r\nexports.CaptchaService = CaptchaService;\r\n"]}